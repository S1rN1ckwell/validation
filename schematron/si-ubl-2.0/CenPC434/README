Based on https://github.com/CenPC434/validation commit c750263a17d8c8cfef63e8c184140a74c1f512cc
